{"ast":null,"code":"import { createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, vModelText as _vModelText, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, vModelSelect as _vModelSelect, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"users\"\n};\nconst _hoisted_2 = [\"onClick\"];\nconst _hoisted_3 = [\"onClick\"];\nconst _hoisted_4 = {\n  key: 1\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_ModalComponent = _resolveComponent(\"ModalComponent\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"button\", {\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.openCreateModal && $options.openCreateModal(...args))\n  }, \"Добавить пользователя\"), _createElementVNode(\"ul\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($props.data, user => {\n    return _openBlock(), _createElementBlock(\"li\", {\n      key: user.id,\n      class: \"user-item\"\n    }, [_createElementVNode(\"h3\", null, _toDisplayString(user.name), 1 /* TEXT */), _createElementVNode(\"p\", null, [_cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \"Email:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(user.email), 1 /* TEXT */)]), _createElementVNode(\"p\", null, [_cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \"Role:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString(user.role), 1 /* TEXT */)]), _createElementVNode(\"button\", {\n      onClick: $event => $options.openEditModal(user)\n    }, \"Edit\", 8 /* PROPS */, _hoisted_2), _createElementVNode(\"button\", {\n      onClick: $event => $options.confirmDeleteUser(user.id)\n    }, \"Delete\", 8 /* PROPS */, _hoisted_3)]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createVNode(_component_ModalComponent, {\n    isOpen: $data.isModalOpen,\n    onClose: _cache[7] || (_cache[7] = $event => $data.isModalOpen = false)\n  }, {\n    header: _withCtx(() => [_createElementVNode(\"h2\", null, _toDisplayString($data.isEditMode ? 'Edit User' : 'Create User'), 1 /* TEXT */)]),\n    body: _withCtx(() => [_withDirectives(_createElementVNode(\"input\", {\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $data.editedUser.name = $event),\n      placeholder: \"User Name\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editedUser.name]]), _withDirectives(_createElementVNode(\"input\", {\n      \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $data.editedUser.email = $event),\n      placeholder: \"User Email\"\n    }, null, 512 /* NEED_PATCH */), [[_vModelText, $data.editedUser.email]]), !$data.isEditMode ? _withDirectives((_openBlock(), _createElementBlock(\"input\", {\n      key: 0,\n      \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $data.editedUser.password = $event),\n      placeholder: \"User Password\",\n      type: \"password\"\n    }, null, 512 /* NEED_PATCH */)), [[_vModelText, $data.editedUser.password]]) : _createCommentVNode(\"v-if\", true), _withDirectives(_createElementVNode(\"select\", {\n      \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $data.editedUser.role = $event)\n    }, _cache[10] || (_cache[10] = [_createElementVNode(\"option\", null, \"Админ\", -1 /* HOISTED */), _createElementVNode(\"option\", null, \"Руководитель проекта\", -1 /* HOISTED */), _createElementVNode(\"option\", null, \"Исполнитель\", -1 /* HOISTED */)]), 512 /* NEED_PATCH */), [[_vModelSelect, $data.editedUser.role]]), $data.serverResponse ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"p\", null, [_cache[11] || (_cache[11] = _createElementVNode(\"strong\", null, \"Пароль пользователя:\", -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($data.serverResponse.notHisPassword), 1 /* TEXT */)])])) : _createCommentVNode(\"v-if\", true)]),\n    footer: _withCtx(() => [_createElementVNode(\"button\", {\n      onClick: _cache[5] || (_cache[5] = $event => $data.isEditMode ? $options.saveUser() : $options.createUser())\n    }, \"Save\"), _createElementVNode(\"button\", {\n      onClick: _cache[6] || (_cache[6] = $event => $data.isModalOpen = false)\n    }, \"Cancel\")]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"isOpen\"])]);\n}","map":{"version":3,"names":["class","key","_createElementBlock","_hoisted_1","_createElementVNode","onClick","_cache","args","$options","openCreateModal","_Fragment","_renderList","$props","data","user","id","_toDisplayString","name","_createTextVNode","email","role","$event","openEditModal","_hoisted_2","confirmDeleteUser","_hoisted_3","_createVNode","_component_ModalComponent","isOpen","$data","isModalOpen","onClose","header","_withCtx","isEditMode","body","editedUser","placeholder","password","type","_createCommentVNode","serverResponse","_hoisted_4","notHisPassword","footer","saveUser","createUser","_"],"sources":["D:\\programs\\osp\\domains\\Project-manager\\project-manager-front\\my-project\\src\\components\\UsersComponent.vue"],"sourcesContent":["<template>\n    <div class=\"users\">\n      <button @click=\"openCreateModal\">Добавить пользователя</button>\n      <ul>\n        <li v-for=\"user in data\" :key=\"user.id\" class=\"user-item\">\n          <h3>{{ user.name }}</h3>\n          <p><strong>Email:</strong> {{ user.email }}</p>\n          <p><strong>Role:</strong> {{ user.role }}</p>\n          <button @click=\"openEditModal(user)\">Edit</button>\n          <button @click=\"confirmDeleteUser(user.id)\">Delete</button>\n        </li>\n      </ul>\n  \n      <ModalComponent :isOpen=\"isModalOpen\" @close=\"isModalOpen = false\">\n        <template #header>\n          <h2>{{ isEditMode ? 'Edit User' : 'Create User' }}</h2>\n        </template>\n        <template #body>\n          <input v-model=\"editedUser.name\" placeholder=\"User Name\" />\n          <input v-model=\"editedUser.email\" placeholder=\"User Email\" />\n          <input v-if=\"!isEditMode\" v-model=\"editedUser.password\" placeholder=\"User Password\" type=\"password\" />\n          <select v-model=\"editedUser.role\">\n            <option>Админ</option>\n            <option>Руководитель проекта</option>\n            <option>Исполнитель</option>\n          </select>\n          <div v-if=\"serverResponse\">\n            <p><strong>Пароль пользователя:</strong> {{ serverResponse.notHisPassword }}</p>\n          </div>\n        </template>\n        <template #footer>\n          <button @click=\"isEditMode ? saveUser() : createUser()\">Save</button>\n          <button @click=\"isModalOpen = false\">Cancel</button>\n        </template>\n      </ModalComponent>\n    </div>\n  </template>\n  \n  <script>\n    import ModalComponent from './ModalComponent.vue';\n  export default {\n    components: {\n      ModalComponent,\n    },\n    props: {\n        data: {\n        type: Array,\n        required: true,\n      },\n    },\n    data() {\n      return {\n        isModalOpen: false,\n        isEditMode: false,\n        editedUser: {},\n        serverResponse: null,\n      };\n    },\n    methods: {\n      openCreateModal() {\n        this.isEditMode = false;\n        this.editedUser = { name: '', email: '', password: '', role: 'Исполнитель' };\n        this.isModalOpen = true;\n        this.serverResponse = null;\n      },\n      createUser() {\n        fetch('http://0.0.0.0:8000/api/admin/users', {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify(this.editedUser),\n        })\n        .then(response => response.json())\n        .then(data => {\n            this.serverResponse = data;\n            this.$emit('userCreated', data.user);\n            // this.isModalOpen = false;\n        })\n        .catch(error => console.error('Error creating user:', error));\n      },\n      formatDate(date) {\n        const options = { year: 'numeric', month: 'long', day: 'numeric' };\n        return new Date(date).toLocaleDateString(undefined, options);\n      },\n      openEditModal(user) {\n      this.isEditMode = true;\n      this.editedUser = { ...user };\n      this.isModalOpen = true;\n    },\n      saveUser() {\n  console.log('Saving user:', this.editedUser);\n\n  fetch(`http://0.0.0.0:8000/api/admin/users/${this.editedUser.id}`, {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify(this.editedUser),\n  })\n  .then(response => {\n    if (response.ok) {\n      console.log('User updated successfully');\n      this.isModalOpen = false; // Закрываем модальное окно\n      this.$emit('userUpdated', this.editedUser); // Эмитируем событие для обновления списка\n    } else {\n      console.error('Failed to update user');\n    }\n  })\n  .catch(error => {\n    console.error('Error updating user:', error);\n  });\n},\n      confirmDeleteUser(userId) {\n        if (confirm('Мис клик или действительно удаляем его? Может простим, пусть живет себе.')) {\n            this.deleteUser(userId);\n        }\n      },\n      deleteUser(userId) {\n        fetch(`http://0.0.0.0:8000/api/admin/users/${userId}`, {\n        method: 'DELETE',\n      })\n      .then(response => {\n        if (response.ok) {\n          console.log('User deleted successfully');\n          this.$emit('userDeleted', userId); // Эмитируем событие для обновления списка\n        } else {\n          console.error('Failed to delete user');\n        }\n      })\n      .catch(error => {\n        console.error('Error deleting user:', error);\n      });\n      },\n    },\n  };\n  </script>\n  \n  <style scoped>\n  .users {\n    padding: 20px;\n    background-color: #f9f9f9;\n    border-radius: 8px;\n  }\n  \n  .user-item {\n    margin-bottom: 20px;\n    padding: 15px;\n    border: 1px solid #ddd;\n    border-radius: 5px;\n    background-color: #fff;\n  }\n  </style>\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}