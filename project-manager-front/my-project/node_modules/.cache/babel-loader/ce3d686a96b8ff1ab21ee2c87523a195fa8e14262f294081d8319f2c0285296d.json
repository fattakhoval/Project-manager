{"ast":null,"code":"import { openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, resolveDynamicComponent as _resolveDynamicComponent, createBlock as _createBlock } from \"vue\";\nconst _hoisted_1 = {\n  key: 0,\n  class: \"main-page\"\n};\nconst _hoisted_2 = {\n  class: \"content\"\n};\nconst _hoisted_3 = {\n  class: \"role-actions\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"info-box\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $props.user ? (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [$props.user.role === 'Админ' ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 0,\n    onClick: _cache[0] || (_cache[0] = $event => $options.selectSection('projects'))\n  }, \"Projects\")) : _createCommentVNode(\"v-if\", true), $props.user.role === 'Админ' ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 1,\n    onClick: _cache[1] || (_cache[1] = $event => $options.selectSection('tasks'))\n  }, \"Tasks\")) : _createCommentVNode(\"v-if\", true), $props.user.role === 'Админ' ? (_openBlock(), _createElementBlock(\"button\", {\n    key: 2,\n    onClick: _cache[2] || (_cache[2] = $event => $options.selectSection('users'))\n  }, \"Users\")) : _createCommentVNode(\"v-if\", true)]), $data.selectedSection ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"h2\", null, _toDisplayString($data.selectedSection.toUpperCase()), 1 /* TEXT */), (_openBlock(), _createBlock(_resolveDynamicComponent($options.currentComponent), {\n    data: $data.sectionData || [],\n    onUserDeleted: $options.handleUserDeleted,\n    onUserUpdated: $options.handleUserUpdated,\n    onUserCreated: $options.handleUserCreated\n  }, null, 40 /* PROPS, NEED_HYDRATION */, [\"data\", \"onUserDeleted\", \"onUserUpdated\", \"onUserCreated\"]))])) : _createCommentVNode(\"v-if\", true)])])) : _createCommentVNode(\"v-if\", true);\n}","map":{"version":3,"names":["key","class","$props","user","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","role","onClick","_cache","$event","$options","selectSection","_createCommentVNode","$data","selectedSection","_hoisted_4","_toDisplayString","toUpperCase","_createBlock","_resolveDynamicComponent","currentComponent","data","sectionData","onUserDeleted","handleUserDeleted","onUserUpdated","handleUserUpdated","onUserCreated","handleUserCreated"],"sources":["D:\\programs\\osp\\domains\\Project-manager\\project-manager-front\\my-project\\src\\components\\MainPageAdmin.vue"],"sourcesContent":["<template>\n  <div class=\"main-page\" v-if=\"user\">\n    <div class=\"content\">\n      <div class=\"role-actions\">\n        <button v-if=\"user.role === 'Админ'\" @click=\"selectSection('projects')\">Projects</button>\n        <button v-if=\"user.role === 'Админ'\" @click=\"selectSection('tasks')\">Tasks</button>\n        <button v-if=\"user.role === 'Админ'\" @click=\"selectSection('users')\">Users</button>\n      </div>\n      <div class=\"info-box\" v-if=\"selectedSection\">\n        <h2>{{ selectedSection.toUpperCase() }}</h2>\n        <component :is=\"currentComponent\" :data=\"sectionData || []\"\n        @userDeleted=\"handleUserDeleted\"\n        @userUpdated=\"handleUserUpdated\"\n        @userCreated=\"handleUserCreated\"\n        ></component>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport ProjectsComponent from './ProjectsComponent.vue';\nimport TasksComponent from './TasksComponent.vue';\nimport UsersComponent from './UsersComponent.vue';\n\nexport default {\n  props: {\n    user: Object,\n  },\n  data() {\n    return {\n      selectedSection: null,\n      sectionData: [],\n    };\n  },\n  computed: {\n    currentComponent() {\n      switch (this.selectedSection) {\n        case 'projects':\n          return ProjectsComponent;\n        case 'tasks':\n          return TasksComponent;\n        case 'users':\n          return UsersComponent;\n        default:\n          return null;\n      }\n    },\n  },\n  methods: {\n    handleUserCreated(newUser) {\n      this.sectionData.push(newUser);\n    },\n    selectSection(section) {\n      this.selectedSection = section;\n      this.fetchSectionData(section);\n    },\n    fetchSectionData(section) {\n      let url = '';\n      switch (section) {\n        case 'projects':\n          url = 'http://127.0.0.1:8000/api/admin/projects/';\n          break;\n        case 'tasks':\n          url = 'http://0.0.0.0:8000/api/manager/tasks';\n          break;\n        case 'users':\n          url = 'http://0.0.0.0:8000/api/admin/users';\n          break;\n      }\n      fetch(url, {\n        method: 'GET',\n        credentials: 'include',\n      })\n      .then(response => response.json())\n      .then(data => {\n        this.sectionData = data;\n      })\n      .catch(error => console.error('Error fetching data:', error));\n    },\n    handleUserDeleted(userId) {\n      // Удаляем пользователя из sectionData\n      this.sectionData = this.sectionData.filter(user => user.id !== userId);\n    },\n    handleUserUpdated(updatedUser) {\n      const index = this.sectionData.findIndex(user => user.id === updatedUser.id);\n      if (index !== -1) {\n        // Заменяем объект пользователя в массиве\n        this.sectionData.splice(index, 1, updatedUser);\n        // Присваиваем новый массив для реактивного обновления\n        this.sectionData = [...this.sectionData];\n      }\n    },\n  },\n  components: {\n    ProjectsComponent,\n    TasksComponent,\n    UsersComponent,\n  },\n};\n</script>\n\n<style scoped>\n.content {\n  padding: 20px;\n}\n.role-actions {\n  margin-bottom: 20px;\n}\n.info-box {\n  border: 1px solid #ccc;\n  padding: 10px;\n  border-radius: 5px;\n}\n</style>\n"],"mappings":";;EAAAA,GAAA;EACOC,KAAK,EAAC;;;EACJA,KAAK,EAAC;AAAS;;EACbA,KAAK,EAAC;AAAc;;EAH/BD,GAAA;EAQWC,KAAK,EAAC;;;SAPcC,MAAA,CAAAC,IAAI,I,cAAjCC,mBAAA,CAgBM,OAhBNC,UAgBM,GAfJC,mBAAA,CAcM,OAdNC,UAcM,GAbJD,mBAAA,CAIM,OAJNE,UAIM,GAHUN,MAAA,CAAAC,IAAI,CAACM,IAAI,gB,cAAvBL,mBAAA,CAAyF;IAJjGJ,GAAA;IAI8CU,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,QAAA,CAAAC,aAAa;KAAc,UAAQ,KAJxFC,mBAAA,gBAKsBb,MAAA,CAAAC,IAAI,CAACM,IAAI,gB,cAAvBL,mBAAA,CAAmF;IAL3FJ,GAAA;IAK8CU,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,QAAA,CAAAC,aAAa;KAAW,OAAK,KALlFC,mBAAA,gBAMsBb,MAAA,CAAAC,IAAI,CAACM,IAAI,gB,cAAvBL,mBAAA,CAAmF;IAN3FJ,GAAA;IAM8CU,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEC,QAAA,CAAAC,aAAa;KAAW,OAAK,KANlFC,mBAAA,e,GAQkCC,KAAA,CAAAC,eAAe,I,cAA3Cb,mBAAA,CAOM,OAPNc,UAOM,GANJZ,mBAAA,CAA4C,YAAAa,gBAAA,CAArCH,KAAA,CAAAC,eAAe,CAACG,WAAW,qB,cAClCC,YAAA,CAIaC,wBAdrB,CAUwBT,QAAA,CAAAU,gBAAgB;IAAGC,IAAI,EAAER,KAAA,CAAAS,WAAW;IACnDC,aAAW,EAAEb,QAAA,CAAAc,iBAAiB;IAC9BC,aAAW,EAAEf,QAAA,CAAAgB,iBAAiB;IAC9BC,aAAW,EAAEjB,QAAA,CAAAkB;8GAbtBhB,mBAAA,e,OAAAA,mBAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}